
AVRASM ver. 2.1.2  prog_mega8_1.asm Thu Jun 29 20:36:31 2006

prog_mega8_1.asm(937): Including file 'prog_mega8_1.vec'
prog_mega8_1.asm(938): Including file 'prog_mega8_1.inc'
prog_mega8_1.inc(2): warning: Register r4 already defined by the .DEF directive
prog_mega8_1.asm(938): 'prog_mega8_1.inc' included form here
prog_mega8_1.inc(5): warning: Register r5 already defined by the .DEF directive
prog_mega8_1.asm(938): 'prog_mega8_1.inc' included form here
prog_mega8_1.inc(6): warning: Register r6 already defined by the .DEF directive
prog_mega8_1.asm(938): 'prog_mega8_1.inc' included form here
prog_mega8_1.inc(7): warning: Register r7 already defined by the .DEF directive
prog_mega8_1.asm(938): 'prog_mega8_1.inc' included form here
prog_mega8_1.inc(8): warning: Register r8 already defined by the .DEF directive
prog_mega8_1.asm(938): 'prog_mega8_1.inc' included form here
prog_mega8_1.inc(9): warning: Register r9 already defined by the .DEF directive
prog_mega8_1.asm(938): 'prog_mega8_1.inc' included form here
prog_mega8_1.inc(10): warning: Register r10 already defined by the .DEF directive
prog_mega8_1.asm(938): 'prog_mega8_1.inc' included form here
prog_mega8_1.inc(11): warning: Register r11 already defined by the .DEF directive
prog_mega8_1.asm(938): 'prog_mega8_1.inc' included form here
prog_mega8_1.inc(12): warning: Register r12 already defined by the .DEF directive
prog_mega8_1.asm(938): 'prog_mega8_1.inc' included form here
                 
                 
                 ;(C) Copyright 1998-2005 Pavel Haiduc, HP InfoTech s.r.l.
                 ;http://www.hpinfotech.com
                 
                 ;Chip type              : ATmega8
                 ;Program type           : Application
                 ;Clock frequency        : 8,000000 MHz
                 ;Memory model           : Small
                 ;Optimize for           : Size
                 ;(s)printf features     : int, width
                 ;(s)scanf features      : int, width
                 ;External SRAM size     : 0
                 ;Data Stack size        : 256 byte(s)
                 ;Heap size              : 0 byte(s)
                 ;Promote char to int    : No
                 ;char is unsigned       : Yes
                 ;8 bit enums            : Yes
                 ;Word align FLASH struct: No
                 ;Enhanced core instructions    : On
                 ;Automatic register allocation : On
                 
                 	#pragma AVRPART ADMIN PART_NAME ATmega8
                 	#pragma AVRPART MEMORY PROG_FLASH 8192
                 	#pragma AVRPART MEMORY EEPROM 512
                 	#pragma AVRPART MEMORY INT_SRAM SIZE 1024
                 	#pragma AVRPART MEMORY INT_SRAM START_ADDR 0x60
                 
                 	.EQU UDRE=0x5
                 	.EQU RXC=0x7
                 	.EQU USR=0xB
                 	.EQU UDR=0xC
                 	.EQU SPSR=0xE
                 	.EQU SPDR=0xF
                 	.EQU EERE=0x0
                 	.EQU EEWE=0x1
                 	.EQU EEMWE=0x2
                 	.EQU EECR=0x1C
                 	.EQU EEDR=0x1D
                 	.EQU EEARL=0x1E
                 	.EQU EEARH=0x1F
                 	.EQU WDTCR=0x21
                 	.EQU MCUCR=0x35
                 	.EQU GICR=0x3B
                 	.EQU SPL=0x3D
                 	.EQU SPH=0x3E
                 	.EQU SREG=0x3F
                 
                 	.DEF R0X0=R0
                 	.DEF R0X1=R1
                 	.DEF R0X2=R2
                 	.DEF R0X3=R3
                 	.DEF R0X4=R4
                 	.DEF R0X5=R5
                 	.DEF R0X6=R6
                 	.DEF R0X7=R7
                 	.DEF R0X8=R8
                 	.DEF R0X9=R9
                 	.DEF R0XA=R10
                 	.DEF R0XB=R11
                 	.DEF R0XC=R12
                 	.DEF R0XD=R13
                 	.DEF R0XE=R14
                 	.DEF R0XF=R15
                 	.DEF R0X10=R16
                 	.DEF R0X11=R17
                 	.DEF R0X12=R18
                 	.DEF R0X13=R19
                 	.DEF R0X14=R20
                 	.DEF R0X15=R21
                 	.DEF R0X16=R22
                 	.DEF R0X17=R23
                 	.DEF R0X18=R24
                 	.DEF R0X19=R25
                 	.DEF R0X1A=R26
                 	.DEF R0X1B=R27
                 	.DEF R0X1C=R28
                 	.DEF R0X1D=R29
                 	.DEF R0X1E=R30
                 	.DEF R0X1F=R31
                 
                 	.EQU __se_bit=0x80
                 	.EQU __sm_mask=0x70
                 	.EQU __sm_adc_noise_red=0x10
                 	.EQU __sm_powerdown=0x20
                 	.EQU __sm_powersave=0x30
                 	.EQU __sm_standby=0x60
                 	.EQU __sm_ext_standby=0x70
                 
                 	.MACRO __CPD1N
                 	CPI  R30,LOW(@0)
                 	LDI  R26,HIGH(@0)
                 	CPC  R31,R26
                 	LDI  R26,BYTE3(@0)
                 	CPC  R22,R26
                 	LDI  R26,BYTE4(@0)
                 	CPC  R23,R26
                 	.ENDM
                 
                 	.MACRO __CPD2N
                 	CPI  R26,LOW(@0)
                 	LDI  R30,HIGH(@0)
                 	CPC  R27,R30
                 	LDI  R30,BYTE3(@0)
                 	CPC  R24,R30
                 	LDI  R30,BYTE4(@0)
                 	CPC  R25,R30
                 	.ENDM
                 
                 	.MACRO __CPWRR
                 	CP   R@0,R@2
                 	CPC  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __CPWRN
                 	CPI  R@0,LOW(@2)
                 	LDI  R30,HIGH(@2)
                 	CPC  R@1,R30
                 	.ENDM
                 
                 	.MACRO __ADDB1MN
                 	SUBI R30,LOW(-@0-(@1))
                 	.ENDM
                 	.MACRO __ADDB2MN
                 	SUBI R26,LOW(-@0-(@1))
                 	.ENDM
                 	.MACRO __ADDW1MN
                 	SUBI R30,LOW(-@0-(@1))
                 	SBCI R31,HIGH(-@0-(@1))
                 	.ENDM
                 	.MACRO __ADDW2MN
                 	SUBI R26,LOW(-@0-(@1))
                 	SBCI R27,HIGH(-@0-(@1))
                 	.ENDM
                 	.MACRO __ADDW1FN
                 	SUBI R30,LOW(-2*@0-(@1))
                 	SBCI R31,HIGH(-2*@0-(@1))
                 	.ENDM
                 	.MACRO __ADDD1FN
                 	SUBI R30,LOW(-2*@0-(@1))
                 	SBCI R31,HIGH(-2*@0-(@1))
                 	SBCI R22,BYTE3(-2*@0-(@1))
                 	.ENDM
                 	.MACRO __ADDD1N
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	SBCI R22,BYTE3(-@0)
                 	SBCI R23,BYTE4(-@0)
                 	.ENDM
                 
                 	.MACRO __ADDD2N
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	SBCI R24,BYTE3(-@0)
                 	SBCI R25,BYTE4(-@0)
                 	.ENDM
                 
                 	.MACRO __SUBD1N
                 	SUBI R30,LOW(@0)
                 	SBCI R31,HIGH(@0)
                 	SBCI R22,BYTE3(@0)
                 	SBCI R23,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __SUBD2N
                 	SUBI R26,LOW(@0)
                 	SBCI R27,HIGH(@0)
                 	SBCI R24,BYTE3(@0)
                 	SBCI R25,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __ANDD1N
                 	ANDI R30,LOW(@0)
                 	ANDI R31,HIGH(@0)
                 	ANDI R22,BYTE3(@0)
                 	ANDI R23,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __ORD1N
                 	ORI  R30,LOW(@0)
                 	ORI  R31,HIGH(@0)
                 	ORI  R22,BYTE3(@0)
                 	ORI  R23,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __DELAY_USB
                 	LDI  R24,LOW(@0)
                 __DELAY_USB_LOOP:
                 	DEC  R24
                 	BRNE __DELAY_USB_LOOP
                 	.ENDM
                 
                 	.MACRO __DELAY_USW
                 	LDI  R24,LOW(@0)
                 	LDI  R25,HIGH(@0)
                 __DELAY_USW_LOOP:
                 	SBIW R24,1
                 	BRNE __DELAY_USW_LOOP
                 	.ENDM
                 
                 	.MACRO __CLRD1S
                 	LDI  R30,0
                 	STD  Y+@0,R30
                 	STD  Y+@0+1,R30
                 	STD  Y+@0+2,R30
                 	STD  Y+@0+3,R30
                 	.ENDM
                 
                 	.MACRO __GETD1S
                 	LDD  R30,Y+@0
                 	LDD  R31,Y+@0+1
                 	LDD  R22,Y+@0+2
                 	LDD  R23,Y+@0+3
                 	.ENDM
                 
                 	.MACRO __PUTD1S
                 	STD  Y+@0,R30
                 	STD  Y+@0+1,R31
                 	STD  Y+@0+2,R22
                 	STD  Y+@0+3,R23
                 	.ENDM
                 
                 	.MACRO __PUTD2S
                 	STD  Y+@0,R26
                 	STD  Y+@0+1,R27
                 	STD  Y+@0+2,R24
                 	STD  Y+@0+3,R25
                 	.ENDM
                 
                 	.MACRO __POINTB1MN
                 	LDI  R30,LOW(@0+@1)
                 	.ENDM
                 
                 	.MACRO __POINTW1MN
                 	LDI  R30,LOW(@0+@1)
                 	LDI  R31,HIGH(@0+@1)
                 	.ENDM
                 
                 	.MACRO __POINTW1FN
                 	LDI  R30,LOW(2*@0+@1)
                 	LDI  R31,HIGH(2*@0+@1)
                 	.ENDM
                 
                 	.MACRO __POINTD1FN
                 	LDI  R30,LOW(2*@0+@1)
                 	LDI  R31,HIGH(2*@0+@1)
                 	LDI  R22,BYTE3(2*@0+@1)
                 	.ENDM
                 
                 	.MACRO __POINTB2MN
                 	LDI  R26,LOW(@0+@1)
                 	.ENDM
                 
                 	.MACRO __POINTW2MN
                 	LDI  R26,LOW(@0+@1)
                 	LDI  R27,HIGH(@0+@1)
                 	.ENDM
                 
                 	.MACRO __POINTBRM
                 	LDI  R@0,LOW(@1)
                 	.ENDM
                 
                 	.MACRO __POINTWRM
                 	LDI  R@0,LOW(@2)
                 	LDI  R@1,HIGH(@2)
                 	.ENDM
                 
                 	.MACRO __POINTBRMN
                 	LDI  R@0,LOW(@1+@2)
                 	.ENDM
                 
                 	.MACRO __POINTWRMN
                 	LDI  R@0,LOW(@2+@3)
                 	LDI  R@1,HIGH(@2+@3)
                 	.ENDM
                 
                 	.MACRO __POINTWRFN
                 	LDI  R@0,LOW(@2*2+@3)
                 	LDI  R@1,HIGH(@2*2+@3)
                 	.ENDM
                 
                 	.MACRO __GETD1N
                 	LDI  R30,LOW(@0)
                 	LDI  R31,HIGH(@0)
                 	LDI  R22,BYTE3(@0)
                 	LDI  R23,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __GETD2N
                 	LDI  R26,LOW(@0)
                 	LDI  R27,HIGH(@0)
                 	LDI  R24,BYTE3(@0)
                 	LDI  R25,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __GETD2S
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	LDD  R24,Y+@0+2
                 	LDD  R25,Y+@0+3
                 	.ENDM
                 
                 	.MACRO __GETB1MN
                 	LDS  R30,@0+@1
                 	.ENDM
                 
                 	.MACRO __GETB1HMN
                 	LDS  R31,@0+@1
                 	.ENDM
                 
                 	.MACRO __GETW1MN
                 	LDS  R30,@0+@1
                 	LDS  R31,@0+@1+1
                 	.ENDM
                 
                 	.MACRO __GETD1MN
                 	LDS  R30,@0+@1
                 	LDS  R31,@0+@1+1
                 	LDS  R22,@0+@1+2
                 	LDS  R23,@0+@1+3
                 	.ENDM
                 
                 	.MACRO __GETBRMN
                 	LDS  R@0,@1+@2
                 	.ENDM
                 
                 	.MACRO __GETWRMN
                 	LDS  R@0,@2+@3
                 	LDS  R@1,@2+@3+1
                 	.ENDM
                 
                 	.MACRO __GETWRZ
                 	LDD  R@0,Z+@2
                 	LDD  R@1,Z+@2+1
                 	.ENDM
                 
                 	.MACRO __GETD2Z
                 	LDD  R26,Z+@0
                 	LDD  R27,Z+@0+1
                 	LDD  R24,Z+@0+2
                 	LDD  R25,Z+@0+3
                 	.ENDM
                 
                 	.MACRO __GETB2MN
                 	LDS  R26,@0+@1
                 	.ENDM
                 
                 	.MACRO __GETW2MN
                 	LDS  R26,@0+@1
                 	LDS  R27,@0+@1+1
                 	.ENDM
                 
                 	.MACRO __GETD2MN
                 	LDS  R26,@0+@1
                 	LDS  R27,@0+@1+1
                 	LDS  R24,@0+@1+2
                 	LDS  R25,@0+@1+3
                 	.ENDM
                 
                 	.MACRO __PUTB1MN
                 	STS  @0+@1,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1MN
                 	STS  @0+@1,R30
                 	STS  @0+@1+1,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1MN
                 	STS  @0+@1,R30
                 	STS  @0+@1+1,R31
                 	STS  @0+@1+2,R22
                 	STS  @0+@1+3,R23
                 	.ENDM
                 
                 	.MACRO __PUTDZ2
                 	STD  Z+@0,R26
                 	STD  Z+@0+1,R27
                 	STD  Z+@0+2,R24
                 	STD  Z+@0+3,R25
                 	.ENDM
                 
                 	.MACRO __PUTBMRN
                 	STS  @0+@1,R@2
                 	.ENDM
                 
                 	.MACRO __PUTWMRN
                 	STS  @0+@1,R@2
                 	STS  @0+@1+1,R@3
                 	.ENDM
                 
                 	.MACRO __PUTBZR
                 	STD  Z+@1,R@0
                 	.ENDM
                 
                 	.MACRO __PUTWZR
                 	STD  Z+@2,R@0
                 	STD  Z+@2+1,R@1
                 	.ENDM
                 
                 	.MACRO __GETW1R
                 	MOV  R30,R@0
                 	MOV  R31,R@1
                 	.ENDM
                 
                 	.MACRO __GETW2R
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	.ENDM
                 
                 	.MACRO __GETWRN
                 	LDI  R@0,LOW(@2)
                 	LDI  R@1,HIGH(@2)
                 	.ENDM
                 
                 	.MACRO __PUTW1R
                 	MOV  R@0,R30
                 	MOV  R@1,R31
                 	.ENDM
                 
                 	.MACRO __PUTW2R
                 	MOV  R@0,R26
                 	MOV  R@1,R27
                 	.ENDM
                 
                 	.MACRO __ADDWRN
                 	SUBI R@0,LOW(-@2)
                 	SBCI R@1,HIGH(-@2)
                 	.ENDM
                 
                 	.MACRO __ADDWRR
                 	ADD  R@0,R@2
                 	ADC  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __SUBWRN
                 	SUBI R@0,LOW(@2)
                 	SBCI R@1,HIGH(@2)
                 	.ENDM
                 
                 	.MACRO __SUBWRR
                 	SUB  R@0,R@2
                 	SBC  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __ANDWRN
                 	ANDI R@0,LOW(@2)
                 	ANDI R@1,HIGH(@2)
                 	.ENDM
                 
                 	.MACRO __ANDWRR
                 	AND  R@0,R@2
                 	AND  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __ORWRN
                 	ORI  R@0,LOW(@2)
                 	ORI  R@1,HIGH(@2)
                 	.ENDM
                 
                 	.MACRO __ORWRR
                 	OR   R@0,R@2
                 	OR   R@1,R@3
                 	.ENDM
                 
                 	.MACRO __EORWRR
                 	EOR  R@0,R@2
                 	EOR  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __GETWRS
                 	LDD  R@0,Y+@2
                 	LDD  R@1,Y+@2+1
                 	.ENDM
                 
                 	.MACRO __PUTWSR
                 	STD  Y+@2,R@0
                 	STD  Y+@2+1,R@1
                 	.ENDM
                 
                 	.MACRO __MOVEWRR
                 	MOV  R@0,R@2
                 	MOV  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __INWR
                 	IN   R@0,@2
                 	IN   R@1,@2+1
                 	.ENDM
                 
                 	.MACRO __OUTWR
                 	OUT  @2+1,R@1
                 	OUT  @2,R@0
                 	.ENDM
                 
                 	.MACRO __CALL1MN
                 	LDS  R30,@0+@1
                 	LDS  R31,@0+@1+1
                 	ICALL
                 	.ENDM
                 
                 	.MACRO __CALL1FN
                 	LDI  R30,LOW(2*@0+@1)
                 	LDI  R31,HIGH(2*@0+@1)
                 	RCALL __GETW1PF
                 	ICALL
                 	.ENDM
                 
                 	.MACRO __CALL2EN
                 	LDI  R26,LOW(@0+@1)
                 	LDI  R27,HIGH(@0+@1)
                 	RCALL __EEPROMRDW
                 	ICALL
                 	.ENDM
                 
                 	.MACRO __GETW1STACK
                 	IN   R26,SPL
                 	IN   R27,SPH
                 	ADIW R26,@0+1
                 	LD   R30,X+
                 	LD   R31,X
                 	.ENDM
                 
                 	.MACRO __NBST
                 	BST  R@0,@1
                 	IN   R30,SREG
                 	LDI  R31,0x40
                 	EOR  R30,R31
                 	OUT  SREG,R30
                 	.ENDM
                 
                 
                 	.MACRO __PUTB1SN
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1SN
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1SN
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	RCALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1SNS
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	ADIW R26,@1
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1SNS
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	ADIW R26,@1
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1SNS
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	ADIW R26,@1
                 	RCALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1PMN
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1PMN
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1PMN
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	RCALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1PMNS
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	ADIW R26,@1
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1PMNS
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	ADIW R26,@1
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1PMNS
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	ADIW R26,@1
                 	RCALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1RN
                 	MOVW R26,R@0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1RN
                 	MOVW R26,R@0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1RN
                 	MOVW R26,R@0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	RCALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1RNS
                 	MOVW R26,R@0
                 	ADIW R26,@1
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1RNS
                 	MOVW R26,R@0
                 	ADIW R26,@1
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1RNS
                 	MOVW R26,R@0
                 	ADIW R26,@1
                 	RCALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1RON
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	SUBI R26,LOW(-@2)
                 	SBCI R27,HIGH(-@2)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1RON
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	SUBI R26,LOW(-@2)
                 	SBCI R27,HIGH(-@2)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1RON
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	SUBI R26,LOW(-@2)
                 	SBCI R27,HIGH(-@2)
                 	RCALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1RONS
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	ADIW R26,@2
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1RONS
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	ADIW R26,@2
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1RONS
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	ADIW R26,@2
                 	RCALL __PUTDP1
                 	.ENDM
                 
                 
                 	.MACRO __GETB1SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	LD   R30,Z
                 	.ENDM
                 
                 	.MACRO __GETB1HSX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	LD   R31,Z
                 	.ENDM
                 
                 	.MACRO __GETW1SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	LD   R0,Z+
                 	LD   R31,Z
                 	MOV  R30,R0
                 	.ENDM
                 
                 	.MACRO __GETD1SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	LD   R0,Z+
                 	LD   R1,Z+
                 	LD   R22,Z+
                 	LD   R23,Z
                 	MOVW R30,R0
                 	.ENDM
                 
                 	.MACRO __GETB2SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R26,X
                 	.ENDM
                 
                 	.MACRO __GETW2SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R0,X+
                 	LD   R27,X
                 	MOV  R26,R0
                 	.ENDM
                 
                 	.MACRO __GETD2SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R0,X+
                 	LD   R1,X+
                 	LD   R24,X+
                 	LD   R25,X
                 	MOVW R26,R0
                 	.ENDM
                 
                 	.MACRO __GETBRSX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@1)
                 	SBCI R31,HIGH(-@1)
                 	LD   R@0,Z
                 	.ENDM
                 
                 	.MACRO __GETWRSX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@2)
                 	SBCI R31,HIGH(-@2)
                 	LD   R@0,Z+
                 	LD   R@1,Z
                 	.ENDM
                 
                 	.MACRO __LSLW8SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	LD   R31,Z
                 	CLR  R30
                 	.ENDM
                 
                 	.MACRO __PUTB1SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	ST   X+,R30
                 	ST   X+,R31
                 	ST   X+,R22
                 	ST   X,R23
                 	.ENDM
                 
                 	.MACRO __CLRW1SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	CLR  R0
                 	ST   Z+,R0
                 	ST   Z,R0
                 	.ENDM
                 
                 	.MACRO __CLRD1SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	CLR  R0
                 	ST   Z+,R0
                 	ST   Z+,R0
                 	ST   Z+,R0
                 	ST   Z,R0
                 	.ENDM
                 
                 	.MACRO __PUTB2SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	ST   Z,R26
                 	.ENDM
                 
                 	.MACRO __PUTW2SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	ST   Z+,R26
                 	ST   Z,R27
                 	.ENDM
                 
                 	.MACRO __PUTD2SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	ST   Z+,R26
                 	ST   Z+,R27
                 	ST   Z+,R24
                 	ST   Z,R25
                 	.ENDM
                 
                 	.MACRO __PUTBSRX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	ST   Z,R@1
                 	.ENDM
                 
                 	.MACRO __PUTWSRX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@2)
                 	SBCI R31,HIGH(-@2)
                 	ST   Z+,R@0
                 	ST   Z,R@1
                 	.ENDM
                 
                 	.MACRO __PUTB1SNX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R0,X+
                 	LD   R27,X
                 	MOV  R26,R0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1SNX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R0,X+
                 	LD   R27,X
                 	MOV  R26,R0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1SNX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R0,X+
                 	LD   R27,X
                 	MOV  R26,R0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X+,R30
                 	ST   X+,R31
                 	ST   X+,R22
                 	ST   X,R23
                 	.ENDM
                 
                 	.MACRO __MULBRR
                 	MULS R@0,R@1
                 	MOV  R30,R0
                 	.ENDM
                 
                 	.MACRO __MULBRRU
                 	MUL  R@0,R@1
                 	MOV  R30,R0
                 	.ENDM
                 
                 	.CSEG
                 	.ORG 0
                 
                 	.INCLUDE "prog_mega8_1.vec"
                 
                 ;INTERRUPT VECTORS
000000 c032      	RJMP __RESET
000001 cffe      	RJMP 0x00
000002 cffd      	RJMP 0x00
000003 cffc      	RJMP 0x00
000004 cffb      	RJMP 0x00
000005 cffa      	RJMP 0x00
000006 cff9      	RJMP 0x00
000007 cff8      	RJMP 0x00
000008 c20b      	RJMP _timer1_ovf_isr
000009 c200      	RJMP _timer0_ovf_isr
00000a cff5      	RJMP 0x00
00000b c056      	RJMP _usart_rx_isr
00000c cff3      	RJMP 0x00
00000d cff2      	RJMP 0x00
00000e cff1      	RJMP 0x00
00000f cff0      	RJMP 0x00
000010 cfef      	RJMP 0x00
000011 c06c      	RJMP _twi_isr
000012 cfed      	RJMP 0x00
                 
                 	.INCLUDE "prog_mega8_1.inc"
                 
                 	.DEF _pAddr=R4
                 _3:
prog_mega8_1.inc(4): warning: .cseg .db misalignment - padding zero byte
prog_mega8_1.asm(938): 'prog_mega8_1.inc' included form here
000013 0001      	.DB  0x1
                 	.DEF _lAddr=R5
                 	.DEF _Count1=R6
                 	.DEF _Count=R7
                 	.DEF _CRCPackRX=R8
                 	.DEF _Count2=R9
                 	.DEF _Count3=R10
                 	.DEF _CountUART=R11
                 	.DEF _CountUART_1=R12
                 _device_name:
000014 614d
000015 6e69
000016 5020
000017 6f72      	.DB  0x4D,0x61,0x69,0x6E,0x20,0x50,0x72,0x6F
000018 7267
000019 6d61
00001a 202e
00001b 6f50      	.DB  0x67,0x72,0x61,0x6D,0x2E,0x20,0x50,0x6F
00001c 7472
prog_mega8_1.inc(16): warning: .cseg .db misalignment - padding zero byte
prog_mega8_1.asm(938): 'prog_mega8_1.inc' included form here
00001d 0000      	.DB  0x72,0x74,0x0
00001e 0000      	.DW  0x0
00001f 0000      	.DW  0x0
000020 0000      	.DW  0x0
000021 0000      	.DW  0x0
000022 0000      	.DW  0x0
000023 0000      	.DW  0x0
                 _my_version:
000024 0001      	.DB  0x1,0x0
                 __PT_GETSTATE_:
000025 0114
000026 6100
000027 6161
000028 6161      	.DB  0x14,0x1,0x0,0x61,0x61,0x61,0x61,0x61
000029 6161
00002a 6161
00002b 6161
00002c 6161      	.DB  0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61
00002d 2061
00002e ff64      	.DB  0x61,0x20,0x64,0xFF
                 
                 __GLOBAL_INI_TBL:
00002f 0001      	.DW  0x01
000030 0004      	.DW  0x04
000031 0026      	.DW  _3*2
                 
000032 0000      	.DW  0
                 _0x69:
                 
                 __RESET:
000033 94f8      	CLI
000034 27ee      	CLR  R30
000035 bbec      	OUT  EECR,R30
                 
                 ;INTERRUPT VECTORS ARE PLACED
                 ;AT THE START OF FLASH
000036 e0f1      	LDI  R31,1
000037 bffb      	OUT  GICR,R31
000038 bfeb      	OUT  GICR,R30
000039 bfe5      	OUT  MCUCR,R30
                 
                 ;DISABLE WATCHDOG
00003a e1f8      	LDI  R31,0x18
00003b bdf1      	OUT  WDTCR,R31
00003c bde1      	OUT  WDTCR,R30
                 
                 ;CLEAR R2-R14
00003d e08d      	LDI  R24,13
00003e e0a2      	LDI  R26,2
00003f 27bb      	CLR  R27
                 __CLEAR_REG:
000040 93ed      	ST   X+,R30
000041 958a      	DEC  R24
000042 f7e9      	BRNE __CLEAR_REG
                 
                 ;CLEAR SRAM
000043 e080      	LDI  R24,LOW(0x400)
000044 e094      	LDI  R25,HIGH(0x400)
000045 e6a0      	LDI  R26,0x60
                 __CLEAR_SRAM:
000046 93ed      	ST   X+,R30
000047 9701      	SBIW R24,1
000048 f7e9      	BRNE __CLEAR_SRAM
                 
                 ;GLOBAL VARIABLES INITIALIZATION
000049 e5ee      	LDI  R30,LOW(__GLOBAL_INI_TBL*2)
00004a e0f0      	LDI  R31,HIGH(__GLOBAL_INI_TBL*2)
                 __GLOBAL_INI_NEXT:
00004b 9185      	LPM  R24,Z+
00004c 9195      	LPM  R25,Z+
00004d 9700      	SBIW R24,0
00004e f061      	BREQ __GLOBAL_INI_END
00004f 91a5      	LPM  R26,Z+
000050 91b5      	LPM  R27,Z+
000051 9005      	LPM  R0,Z+
000052 9015      	LPM  R1,Z+
000053 01bf      	MOVW R22,R30
000054 01f0      	MOVW R30,R0
                 __GLOBAL_INI_LOOP:
000055 9005      	LPM  R0,Z+
000056 920d      	ST   X+,R0
000057 9701      	SBIW R24,1
000058 f7e1      	BRNE __GLOBAL_INI_LOOP
000059 01fb      	MOVW R30,R22
00005a cff0      	RJMP __GLOBAL_INI_NEXT
                 __GLOBAL_INI_END:
                 
                 ;STACK POINTER INITIALIZATION
00005b e5ef      	LDI  R30,LOW(0x45F)
00005c bfed      	OUT  SPL,R30
00005d e0e4      	LDI  R30,HIGH(0x45F)
00005e bfee      	OUT  SPH,R30
                 
                 ;DATA STACK POINTER INITIALIZATION
00005f e6c0      	LDI  R28,LOW(0x160)
000060 e0d1      	LDI  R29,HIGH(0x160)
                 
000061 c1e2      	RJMP _main
                 
                 	.ESEG
                 	.ORG 0
                 
                 	.DSEG
                 	.ORG 0x160
                 ;       1 /*****************************************************
                 ;       2 This program was produced by the
                 ;       3 CodeWizardAVR V1.24.5 Standard
                 ;       4 Automatic Program Generator
                 ;       5 © Copyright 1998-2005 Pavel Haiduc, HP InfoTech s.r.l.
                 ;       6 http://www.hpinfotech.com
                 ;       7 e-mail:office@hpinfotech.com
                 ;       8 
                 ;       9 Project : 
                 ;      10 Version : 
                 ;      11 Date    : 01.03.2006
                 ;      12 Author  : TeleSys Embedded                
                 ;      13 Company : FastmanSoft Inc.                
                 ;      14 Comments: 
                 ;      15 
                 ;      16 
                 ;      17 Chip type           : ATmega8
                 ;      18 Program type        : Application
                 ;      19 Clock frequency     : 8,000000 MHz
                 ;      20 Memory model        : Small
                 ;      21 External SRAM size  : 0
                 ;      22 Data Stack size     : 256
                 ;      23 *****************************************************/
                 ;      24 
                 ;      25 #include <mega8.h> 
                 ;      26 #include "string.h"  
                 ;      27 
                 ;      28 
                 ;      29 // Standard Input/Output functions
                 ;      30 #include <stdio.h>
                 ;      31 #include <delay.h>
                 ;      32 #include <CDdef.h>					// мой описатель
                 ;      33 
                 ;      34 //unsigned char Count1	=	0,  Count	=	0, lPack = 0;	
                 ;      35 unsigned char rxBuffer[256];							// приемный буффер
                 _rxBuffer:
000160           	.BYTE 0x100
                 ;      36 unsigned char txBuffer[256];								// передающий буффер
                 _txBuffer:
000260           	.BYTE 0x100
                 ;      37 
                 ;      38 unsigned char Count1	=	0,  Count	=	0, CRCPackRX = 0;	
                 ;      39 unsigned char Count2	=	0,  Count3 =	0; 
                 ;      40 unsigned char CountUART = 0, CountUART_1 = 0;      
                 ;      41 
                 ;      42 
                 ;      43 
                 ;      44 
                 ;      45 /*
                 ;      46 // Жду флажка
                 ;      47 static void twi_wait_int (void)
                 ;      48 {
                 ;      49 	while (!(TWCR & (1<<TWINT))); 
                 ;      50 }
                 ;      51   
                 ;      52 */
                 ;      53 	// Флаги состояния
                 ;      54 bit 		ping		 			=		0;									// Признак что прошел первый пинг		
                 ;      55 bit		dPresent			=		0;									// признак наличия подкл. устройства
                 ;      56 bit		time_is_Out		=		0;									// Сработал тайм - аут        
                 ;      57 bit		startPacket		=		0;									// принят признак старта приема
                 ;      58 bit		rxPack				=		0;									// принят пакет																						
                 ;      59 bit		txPack				=		0;									// есть данные на передачу
                 ;      60 bit 		rxPackUART 		= 		0;									// принят пакет по UART
                 ;      61 bit 		tstPort				=		0;									// пора проверить подключенное устройство
                 ;      62 bit 		GlobalAddr 		= 		0;									// Признак ""глобального вызова" 
                 ;      63 bit		to_Reboot			=		0;									// на перезагрузку в Загрузчик
                 ;      64 bit		print					=		0;									// вывести на печать
                 ;      65 
                 ;      66 
                 ;      67 // USART Receiver interrupt service routine
                 ;      68 interrupt [USART_RXC] void usart_rx_isr(void)      
                 ;      69 {     
                 
                 	.CSEG
                 _usart_rx_isr:
000062 d22a      	RCALL SUBOPT_0x0
                 ;      70 	unsigned char data;
                 ;      71 	data = UDR;
000063 930a      	ST   -Y,R16
                 ;	data -> R16
000064 b10c      	IN   R16,12
                 ;      72 
                 ;      73 	TCNT1H=0x00;						// перезапускаем таймер опроса подч. устройства
000065 d235      	RCALL SUBOPT_0x1
                 ;      74 	TCNT1L=0x00;
                 ;      75 
                 ;      76 
                 ;      77 if ((UCSRA & (FRAMING_ERROR | PARITY_ERROR | DATA_OVERRUN))==0)
000066 b1eb      	IN   R30,0xB
000067 71ec      	ANDI R30,LOW(0x1C)
000068 f491      	BRNE _0x4
                 ;      78 	{
                 ;      79 
                 ;      80 	if (!(txPack)) 
000069 fc25      	SBRC R2,5
00006a c010      	RJMP _0x5
                 ;      81 	{
                 ;      82 
                 ;      83 	if (!(CountUART)) 		            	// Прием с начала
00006b 20bb      	TST  R11
00006c f431      	BRNE _0x6
                 ;      84 		{ 
                 ;      85 			if (!rxPackUART)           // предыдущий пакет передан?
00006d fc26      	SBRC R2,6
00006e c003      	RJMP _0x7
                 ;      86 				{
                 ;      87 					CountUART_1 = 0;
00006f 24cc      	CLR  R12
                 ;      88 					txBuffer [CountUART_1++] = data;
000070 d22e      	RCALL SUBOPT_0x2
                 ;      89 					CountUART = data;
000071 2eb0      	MOV  R11,R16
                 ;      90 				} 
                 ;      91 		}
                 _0x7:
                 ;      92 	else
000072 c008      	RJMP _0x8
                 _0x6:
                 ;      93 		{                                                  // продолжаем прием пакета
                 ;      94 			txBuffer[CountUART_1++] = data;
000073 d22b      	RCALL SUBOPT_0x2
                 ;      95 			if (!(--CountUART)) 				// принят весь пакет
000074 94ba      	DEC  R11
000075 f429      	BRNE _0x9
                 ;      96 				{
                 ;      97 					if (checkCRCtx()) rxPackUART = 1;
000076 d10a      	RCALL _checkCRCtx
000077 30e0      	CPI  R30,0
000078 f011      	BREQ _0xA
000079 9468      	SET
00007a f826      	BLD  R2,6
                 ;      98 				}
                 _0xA:
                 ;      99 		}
                 _0x9:
                 _0x8:
                 ;     100      } 
                 ;     101      }
                 _0x5:
                 ;     102 }
                 _0x4:
00007b 9109      	LD   R16,Y+
00007c d229      	RCALL SUBOPT_0x3
00007d 9518      	RETI
                 ;     103 
                 ;     104 
                 ;     105 
                 ;     106 
                 ;     107 // ------------------  Обработка прерывания TWI ---------------------------
                 ;     108 // 2 Wire bus interrupt service routine
                 ;     109 interrupt [TWI] void twi_isr(void)
                 ;     110 {
                 _twi_isr:
00007e d20e      	RCALL SUBOPT_0x0
                 ;     111 	// Поступил запрос по нашему адресу
                 ;     112          if (TWSR == D_Call ) GlobalAddr =0;								// локальный адрес
00007f b1e1      	IN   R30,0x1
000080 38e0      	CPI  R30,LOW(0x80)
000081 f411      	BRNE _0xB
000082 94e8      	CLT
000083 f830      	BLD  R3,0
                 ;     113          if (TWSR == G_Call ) GlobalAddr =1;	          // Действия при глобальной адресации
                 _0xB:
000084 b1e1      	IN   R30,0x1
000085 39e0      	CPI  R30,LOW(0x90)
000086 f411      	BRNE _0xC
000087 9468      	SET
000088 f830      	BLD  R3,0
                 ;     114 
                 ;     115 				if (!(Count1))
                 _0xC:
000089 2066      	TST  R6
00008a f491      	BRNE _0xD
                 ;     116 						{
                 ;     117 
                 ;     118 							if (!startPacket)
00008b fc23      	SBRC R2,3
00008c c00d      	RJMP _0xE
                 ;     119 								{						
                 ;     120 									switch	(TWDR)
00008d b1e3      	IN   R30,0x3
                 ;     121 										{
                 ;     122 											case startPing: 						// принят пинг при опросе кол-ва устройств
00008e 3aea      	CPI  R30,LOW(0xAA)
00008f f419      	BRNE _0x12
                 ;     123 												{ 
                 ;     124 													ping = 1;  
000090 9468      	SET
000091 f820      	BLD  R2,0
                 ;     125 													break;
000092 c006      	RJMP _0x11
                 ;     126 												}
                 ;     127 											case startPack: 						// принят признак начала пакета
                 _0x12:
000093 37e1      	CPI  R30,LOW(0x71)
000094 f421      	BRNE _0x11
                 ;     128 												{ 
                 ;     129 													startPacket = 1;	// ставим признак
000095 9468      	SET
000096 f823      	BLD  R2,3
                 ;     130 													Count	= 0;
000097 2477      	CLR  R7
                 ;     131 													rxBuffer [Count++] = TWDR;			// принятый байт - в буффер
000098 d21b      	RCALL SUBOPT_0x4
                 ;     132 													break;
                 ;     133 												}
                 ;     134 										}
                 _0x11:
                 ;     135 								}
                 ;     136 							else 
000099 c002      	RJMP _0x14
                 _0xE:
                 ;     137 								{
                 ;     138 									Count1 = TWDR;                  // длинна пакета        
00009a b063      	IN   R6,3
                 ;     139 									rxBuffer [Count++] = TWDR;
00009b d218      	RCALL SUBOPT_0x4
                 ;     140 								};
                 _0x14:
                 ;     141 								
                 ;     142 	    		 		}
                 ;     143 				else
00009c c00c      	RJMP _0x15
                 _0xD:
                 ;     144 						{
                 ;     145 							Count1--;
00009d 946a      	DEC  R6
                 ;     146 							rxBuffer[Count++]=TWDR;
00009e d215      	RCALL SUBOPT_0x4
                 ;     147 							if (!(Count1))
00009f 2066      	TST  R6
0000a0 f441      	BRNE _0x16
                 ;     148 								{
                 ;     149 									CRCPackRX	= TWDR;												// КС
0000a1 b083      	IN   R8,3
                 ;     150 									startPacket = 0;						// конец приема пакета
0000a2 94e8      	CLT
0000a3 f823      	BLD  R2,3
                 ;     151 									if (checkCRCrx())	rxPack = 1;	// При CRC-ok -принят пакет
0000a4 d0ca      	RCALL _checkCRCrx
0000a5 30e0      	CPI  R30,0
0000a6 f011      	BREQ _0x17
0000a7 9468      	SET
0000a8 f824      	BLD  R2,4
                 ;     152 								}
                 _0x17:
                 ;     153 						}
                 _0x16:
                 _0x15:
                 ;     154 	    	   
                 ;     155 	                
                 ;     156 
                 ;     157 //          // Действия при глобальной адресации
                 ;     158 //         if (TWSR == G_Call ) 
                 ;     159 //                	{
                 ;     160 //                		putchar (TWDR);
                 ;     161 //                	}    
                 ;     162                 
                 ;     163 
                 ;     164 
                 ;     165 		// отправляем в ответ сформированный буффер
                 ;     166          if ((TWSR == D_Responce)||(TWSR == Addr_Responce))
0000a9 b1e1      	IN   R30,0x1
0000aa 3be8      	CPI  R30,LOW(0xB8)
0000ab f019      	BREQ _0x19
0000ac b1e1      	IN   R30,0x1
0000ad 3ae8      	CPI  R30,LOW(0xA8)
0000ae f4d1      	BRNE _0x18
                 _0x19:
                 ;     167          	{
                 ;     168 				if (!(Count3))
0000af 20aa      	TST  R10
0000b0 f479      	BRNE _0x1B
                 ;     169 						{
                 ;     170 							if (!txPack) TWDR = 0;
0000b1 fc25      	SBRC R2,5
0000b2 c003      	RJMP _0x1C
0000b3 e0e0      	LDI  R30,LOW(0)
0000b4 b9e3      	OUT  0x3,R30
                 ;     171 							else 
0000b5 c009      	RJMP _0x1D
                 _0x1C:
                 ;     172 								{
                 ;     173 									Count2=0;
0000b6 2499      	CLR  R9
                 ;     174 									Count3 = txBuffer [0]+1;
0000b7 91e0 0260 	LDS  R30,_txBuffer
0000b9 5fef      	SUBI R30,-LOW(1)
0000ba 2eae      	MOV  R10,R30
                 ;     175 									TWDR = txBuffer [Count2++]; 
0000bb d201      	RCALL SUBOPT_0x5
                 ;     176 if (print) putchar (TWDR);									 
0000bc fc32      	SBRC R3,2
0000bd d207      	RCALL SUBOPT_0x6
                 ;     177 									Count3--;
0000be 94aa      	DEC  R10
                 ;     178 								}
                 _0x1D:
                 ;     179 						}
                 ;     180 				else
0000bf c009      	RJMP _0x1F
                 _0x1B:
                 ;     181 						{
                 ;     182 							TWDR = txBuffer [ Count2++];
0000c0 d1fc      	RCALL SUBOPT_0x5
                 ;     183 if (print) putchar (TWDR);									 
0000c1 fc32      	SBRC R3,2
0000c2 d202      	RCALL SUBOPT_0x6
                 ;     184 							Count3--;
0000c3 94aa      	DEC  R10
                 ;     185 							if (!(Count3)) 
0000c4 20aa      	TST  R10
0000c5 f419      	BRNE _0x21
                 ;     186 								{
                 ;     187 									txPack = 0;		//пакет отправлен
0000c6 94e8      	CLT
0000c7 f825      	BLD  R2,5
                 ;     188 print = 0;
0000c8 f832      	BLD  R3,2
                 ;     189 								}
                 ;     190 						}
                 _0x21:
                 _0x1F:
                 ;     191          	}
                 ;     192 
                 ;     193          TWCR = ((1<<TWINT) | (1<<TWEA) | (1<<TWEN) |(1<<TWIE)); //Импульс подтверждения I2C
                 _0x18:
0000c9 ece5      	LDI  R30,LOW(197)
0000ca bfe6      	OUT  0x36,R30
                 ;     194 }
0000cb d1da      	RCALL SUBOPT_0x3
0000cc 9518      	RETI
                 ;     195 //--------------------------------------------------------------------------------------
                 ;     196 
                 ;     197 
                 ;     198 // Подключаемые файлы программы
                 ;     199 #include <CDlayer2.c>
                 ;     200 #include <CDlayer3.c>
                 ;     201 flash unsigned char device_name[32] =					// Имя устройства
                 ;     202 		"Main Program. Port";
                 ;     203 eeprom unsigned long my_ser_num = 1;					// Серийный номер устройства
                 
                 	.ESEG
                 _my_ser_num:
000000 01 00     	.DW  0x1
000002 00 00     	.DW  0x0
                 ;     204 const flash unsigned short my_version = 1;			// Версия софта 
                 
                 	.CSEG
                 ;     205 //eeprom unsigned char my_addr = TO_MON;					// Мой адрес - изначально TO_MON
                 ;     206 
                 ;     207 //-----------------------------------------------------------------------------------------------------------------
                 ;     208 //-----------------------------------------------------------------------------------------------------------------
                 ;     209 // Реакция на команду перейти в рабочий режим
                 ;     210 void ToWorkMode(void)
                 ;     211 {
                 _ToWorkMode:
                 ;     212 
                 ;     213 	// Отправляю ответ
                 ;     214 	txBuffer[0] = 1;        						// подтверждаю прием
0000cd d1fa      	RCALL SUBOPT_0x7
                 ;     215 	txBuffer[1] = 1;        						// подтверждаю прием
0000ce 93e0 0261 	__PUTB1MN _txBuffer,1
                 ;     216 
                 ;     217 	txPack = 1;								// есть данные
0000d0 9468      	SET
0000d1 f825      	BLD  R2,5
                 ;     218 }
0000d2 9508      	RET
                 ;     219 // Назначение серийного номера устройства
                 ;     220 static void SetSerial(void)
                 ;     221 {
                 _SetSerial_G1:
                 ;     222 /*	#define ssp ((RQ_SETSERIAL *)rx0buf)
                 ;     223 	
                 ;     224 	if (my_ser_num)
                 ;     225 	{
                 ;     226 		txBuffer[0] = 2;  			//длина
                 ;     227 		txBuffer[1] = (RES_ERR);		
                 ;     228 		txBuffer[2] = 2;          // КС
                 ;     229 
                 ;     230 		txPack = 1;		// есть пакет на передачу
                 ;     231 
                 ;     232 		return;
                 ;     233 	}
                 ;     234 	
                 ;     235 	my_ser_num = ssp->num;*/
                 ;     236 	
                 ;     237 		txBuffer[0] = 2;  			//длина
0000d3 d1f8      	RCALL SUBOPT_0x8
                 ;     238 		txBuffer[1] = (RES_OK);		
0000d4 e0e1      	LDI  R30,LOW(1)
0000d5 93e0 0261 	__PUTB1MN _txBuffer,1
                 ;     239 		txBuffer[2] = 2+(RES_OK);          // КС
0000d7 e0e3      	LDI  R30,LOW(3)
0000d8 93e0 0262 	__PUTB1MN _txBuffer,2
                 ;     240 
                 ;     241 		txPack = 1;		// есть пакет на передачу
0000da 9468      	SET
0000db f825      	BLD  R2,5
                 ;     242 }
0000dc 9508      	RET
                 ;     243 
                 ;     244 //  Назначение адреса устройства
                 ;     245 void Setaddr (void)
                 ;     246 	{
                 _Setaddr:
                 ;     247 		txBuffer[0] = 2;  			//длина
0000dd d1ee      	RCALL SUBOPT_0x8
                 ;     248 		txBuffer[1] = 0;		
0000de e0e0      	LDI  R30,LOW(0)
0000df 93e0 0261 	__PUTB1MN _txBuffer,1
                 ;     249 		txBuffer[2] = 2;          // КС
0000e1 e0e2      	LDI  R30,LOW(2)
0000e2 93e0 0262 	__PUTB1MN _txBuffer,2
                 ;     250 
                 ;     251 		txPack = 1;		// есть пакет на передачу
0000e4 9468      	SET
0000e5 f825      	BLD  R2,5
                 ;     252 	}
0000e6 9508      	RET
                 ;     253 
                 ;     254 // Перезагрузка в режим программирования
                 ;     255 static void ToProg(void)
                 ;     256 {
                 _ToProg_G1:
                 ;     257 	// Отправляю ответ
                 ;     258 		txBuffer[0] = 1;  			//длина
0000e7 d1e0      	RCALL SUBOPT_0x7
                 ;     259 		txBuffer[1] = 1;          // КС
0000e8 93e0 0261 	__PUTB1MN _txBuffer,1
                 ;     260 		
                 ;     261 		txPack = 1;		// есть пакет на передачу
0000ea 9468      	SET
0000eb f825      	BLD  R2,5
                 ;     262 		delay_ms(50);
0000ec e3e2      	LDI  R30,LOW(50)
0000ed e0f0      	LDI  R31,HIGH(50)
0000ee 93fa      	ST   -Y,R31
0000ef 93ea      	ST   -Y,R30
0000f0 d21b      	RCALL _delay_ms
                 ;     263 
                 ;     264 	// На перезагрузку в монитор
                 ;     265 		IVCREG = 1 << IVCE;
0000f1 e0e1      	LDI  R30,LOW(1)
0000f2 bfeb      	OUT  0x3B,R30
                 ;     266 		IVCREG = 1 << IVSEL;
0000f3 e0e2      	LDI  R30,LOW(2)
0000f4 bfeb      	OUT  0x3B,R30
                 ;     267 		#asm("rjmp 0xC00");
0000f5 cb0a      	rjmp 0xC00
                 ;     268 }
0000f6 9508      	RET
                 ;     269 
                 ;     270 
                 ;     271 // Возвращаю состояние устройства
                 ;     272 const char _PT_GETSTATE_[]={20,1,0,'a','a','a','a','a','a','a','a','a','a','a','a','a','a',' ',100,255};
                 ;     273 static void GetState(void)
                 ;     274 {
                 _GetState_G1:
                 ;     275 	register unsigned char a, crc=0;
                 ;     276 	
                 ;     277 		memcpyf(txBuffer, _PT_GETSTATE_, _PT_GETSTATE_[0]+1);
0000f7 d246      	RCALL __SAVELOCR2
                 ;	a -> R16
                 ;	crc -> R17
0000f8 e010      	LDI  R17,0
0000f9 e6e0      	LDI  R30,LOW(_txBuffer)
0000fa e0f2      	LDI  R31,HIGH(_txBuffer)
0000fb d1d4      	RCALL SUBOPT_0x9
0000fc d1d3      	RCALL SUBOPT_0x9
0000fd 91e4      	LPM  R30,Z
0000fe 5fef      	SUBI R30,-LOW(1)
0000ff e0f0      	LDI  R31,0
000100 93fa      	ST   -Y,R31
000101 93ea      	ST   -Y,R30
000102 d1f9      	RCALL _memcpyf
                 ;     278 		for (a=0;a<=txBuffer[0]-1;a++) 
000103 e000      	LDI  R16,LOW(0)
                 _0x23:
000104 d1d0      	RCALL SUBOPT_0xA
000105 17e0      	CP   R30,R16
000106 f028      	BRLO _0x24
                 ;     279 			{
                 ;     280 				crc += txBuffer[a];	//KC
000107 d1d1      	RCALL SUBOPT_0xB
000108 d1d3      	RCALL SUBOPT_0xC
000109 0f1e      	ADD  R17,R30
                 ;     281 			};
00010a 5f0f      	SUBI R16,-1
00010b cff8      	RJMP _0x23
                 _0x24:
                 ;     282 		txBuffer[a] = crc;
00010c 2fa0      	MOV  R26,R16
00010d e0b0      	LDI  R27,0
00010e 5aa0      	SUBI R26,LOW(-_txBuffer)
00010f 4fbd      	SBCI R27,HIGH(-_txBuffer)
000110 931c      	ST   X,R17
                 ;     283 print = 1;
000111 9468      	SET
000112 f832      	BLD  R3,2
                 ;     284 		txPack = 1;		// есть пакет на передачу
000113 f825      	BLD  R2,5
                 ;     285 
                 ;     286 /*		while (txPack);				// ждем передачи
                 ;     287 
                 ;     288 //		txBuffer[0] = 4;				 			// длина пакета
                 ;     289 		txBuffer[1] = 1;
                 ;     290 		txBuffer[2] = 1;
                 ;     291 		txBuffer[3] = 1;
                 ;     292 		txBuffer[4] = 7;//2+lAddr;	 			//КС  
                 ;     293 print = 1;
                 ;     294 
                 ;     295 		txPack = 1;		// есть пакет на передачу*/
                 ;     296 		
                 ;     297 		
                 ;     298 } 
000114 c07f      	RJMP _0x68
                 ;     299 
                 ;     300 // Информация об устройстве:
                 ;     301 
                 ;     302 static void GetInfo(void)
                 ;     303 {
                 _GetInfo_G1:
                 ;     304 	register unsigned char i,a,crc=0;                    
                 ;     305 //putchar (0x01);		
                 ;     306 	
                 ;     307 	// 	заполняю буфер
                 ;     308 	txBuffer[0] = 40+1;
000115 d227      	RCALL __SAVELOCR3
                 ;	i -> R16
                 ;	a -> R17
                 ;	crc -> R18
000116 e020      	LDI  R18,0
000117 e2e9      	LDI  R30,LOW(41)
000118 93e0 0260 	STS  _txBuffer,R30
                 ;     309 	
                 ;     310 	for (i = 0; i < 32; i ++)	// Имя устройства
00011a e000      	LDI  R16,LOW(0)
                 _0x26:
00011b 3200      	CPI  R16,32
00011c f458      	BRSH _0x27
                 ;     311 	{
                 ;     312 		txBuffer[i+1] = device_name[i];
00011d d1bb      	RCALL SUBOPT_0xB
00011e 59ef
00011f 4ffd      	__ADDW1MN _txBuffer,1
000120 01df      	MOVW R26,R30
000121 d1b7      	RCALL SUBOPT_0xB
000122 5de8      	SUBI R30,LOW(-_device_name*2)
000123 4fff      	SBCI R31,HIGH(-_device_name*2)
000124 91e4      	LPM  R30,Z
000125 93ec      	ST   X,R30
                 ;     313 	}
000126 5f0f      	SUBI R16,-1
000127 cff3      	RJMP _0x26
                 _0x27:
                 ;     314 
                 ;     315 		txBuffer[33] = my_ser_num;           // Серийный номер
000128 e0a0      	LDI  R26,LOW(_my_ser_num)
000129 e0b0      	LDI  R27,HIGH(_my_ser_num)
00012a d1fd      	RCALL __EEPROMRDD
00012b 93e0 0281 	__PUTB1MN _txBuffer,33
                 ;     316 		txBuffer[34] = my_ser_num>>8;      // Серийный номер
00012d e0a0      	LDI  R26,LOW(_my_ser_num)
00012e e0b0      	LDI  R27,HIGH(_my_ser_num)
00012f d1f8      	RCALL __EEPROMRDD
000130 01df      	MOVW R26,R30
000131 01cb      	MOVW R24,R22
000132 e0e8      	LDI  R30,LOW(8)
000133 d1e4      	RCALL __LSRD12
000134 93e0 0282 	__PUTB1MN _txBuffer,34
                 ;     317 
                 ;     318 		txBuffer[35] = 0;	// Серийный номер
000136 e0e0      	LDI  R30,LOW(0)
000137 93e0 0283 	__PUTB1MN _txBuffer,35
                 ;     319 		txBuffer[36] = 0;	// Серийный номер
000139 93e0 0284 	__PUTB1MN _txBuffer,36
                 ;     320 	
                 ;     321 		txBuffer[37] =pAddr ;     // Адрес устройстав
00013b 9240 0285 	__PUTBMRN _txBuffer,37,4
                 ;     322 
                 ;     323 		txBuffer[38] =0;     // Зарезервированный байт
00013d 93e0 0286 	__PUTB1MN _txBuffer,38
                 ;     324 	
                 ;     325 		txBuffer[39] = my_version;             // Версия
00013f e8a7
000140 e0b2      	__POINTW2MN _txBuffer,39
000141 e4e8      	LDI  R30,LOW(_my_version*2)
000142 e0f0      	LDI  R31,HIGH(_my_version*2)
000143 d1e0      	RCALL __GETW1PF
000144 93ec      	ST   X,R30
                 ;     326 		txBuffer[40] = my_version>>8;		// Версия
000145 e4e8      	LDI  R30,LOW(_my_version*2)
000146 e0f0      	LDI  R31,HIGH(_my_version*2)
000147 d1dc      	RCALL __GETW1PF
000148 2fef      	MOV  R30,R31
000149 e0f0      	LDI  R31,0
00014a 93e0 0288 	__PUTB1MN _txBuffer,40
                 ;     327 		
                 ;     328 		for (a=0;a<=txBuffer[0]-1;a++) crc += txBuffer[a];	//KC
00014c e010      	LDI  R17,LOW(0)
                 _0x29:
00014d d187      	RCALL SUBOPT_0xA
00014e 17e1      	CP   R30,R17
00014f f028      	BRLO _0x2A
000150 d18f      	RCALL SUBOPT_0xD
000151 d18a      	RCALL SUBOPT_0xC
000152 0f2e      	ADD  R18,R30
                 ;     329 		txBuffer[41] = crc;
000153 5f1f      	SUBI R17,-1
000154 cff8      	RJMP _0x29
                 _0x2A:
000155 9320 0289 	__PUTBMRN _txBuffer,41,18
                 ;     330 	
                 ;     331 
                 ;     332 		txPack = 1;		// есть пакет на передачу 
000157 9468      	SET
000158 f825      	BLD  R2,5
                 ;     333 //putchar (0x02);		
                 ;     334 }
000159 d1e7      	RCALL __LOADLOCR3
00015a 9623      	ADIW R28,3
00015b 9508      	RET
                 ;     335 
                 ;     336 
                 ;     337 // Отвечаем. Заполняем буффер на передачу
                 ;     338 void _GetLogAddr (void)
                 ;     339 	{
                 __GetLogAddr:
                 ;     340 	
                 ;     341 		txBuffer[0] = 2;				 			// длина пакета
00015c d16f      	RCALL SUBOPT_0x8
                 ;     342 		txBuffer[1] = lAddr;		  			// лог. адрес
00015d 9250 0261 	__PUTBMRN _txBuffer,1,5
                 ;     343 		txBuffer[2] = 2+lAddr;	 			//КС  
00015f 2de5      	MOV  R30,R5
000160 5fee      	SUBI R30,-LOW(2)
000161 93e0 0262 	__PUTB1MN _txBuffer,2
                 ;     344 
                 ;     345 		txPack = 1;		// есть пакет на передачу
000163 9468      	SET
000164 f825      	BLD  R2,5
                 ;     346 	
                 ;     347 	}  
000165 9508      	RET
                 ;     348 	
                 ;     349 // Отладочные пакеты
                 ;     350 void _OP (unsigned char c)
                 ;     351 	{
                 ;     352 		unsigned char a =0, b;
                 ;     353 
                 ;     354 		txBuffer[0] = c;					// длина пакета
                 ;	c -> Y+2
                 ;	a -> R16
                 ;	b -> R17
                 ;     355 
                 ;     356 		for (b=0;b< txBuffer [0]; b++)
                 ;     357 			{
                 ;     358 				a=a+txBuffer [b];
                 ;     359 			}                            
                 ;     360 			
                 ;     361 		txBuffer [b] = a;					//KC
                 ;     362 
                 ;     363 		txPack = 1;		// есть пакет на передачу
                 ;     364 		
                 ;     365 	}
                 ;     366 
                 ;     367 static void give_GETINFO (void)
                 ;     368 {
                 _give_GETINFO_G1:
                 ;     369 	
                 ;     370 	// 	Начинаю запрос  типа устройства
                 ;     371 			putchar ('q');						// заголовок
000166 e7e1      	LDI  R30,LOW(113)
000167 d17b      	RCALL SUBOPT_0xE
                 ;     372 			putchar (3);							// число байт после этого
000168 d17c      	RCALL SUBOPT_0xF
                 ;     373 			putchar (255);		 				//  адрес (циркулярный)
000169 efef      	LDI  R30,LOW(255)
00016a d178      	RCALL SUBOPT_0xE
                 ;     374 			putchar (PT_GETINFO);		// тип пакета
00016b d179      	RCALL SUBOPT_0xF
                 ;     375 			putchar ((PT_GETINFO)+(255)+3+('q'));
00016c e7e6      	LDI  R30,LOW(374)
00016d d175      	RCALL SUBOPT_0xE
                 ;     376 				
                 ;     377 }
00016e 9508      	RET
                 ;     378 
                 ;     379 // Подсчет CRC приемного буффера
                 ;     380 unsigned char checkCRCrx (void)
                 ;     381 	{
                 _checkCRCrx:
                 ;     382 		unsigned char a =0, b; 
                 ;     383 		for (b=0;b<= rxBuffer [1]; b++)
00016f d1ce      	RCALL __SAVELOCR2
                 ;	a -> R16
                 ;	b -> R17
000170 e000      	LDI  R16,0
000171 e010      	LDI  R17,LOW(0)
                 _0x2F:
000172 91e0 0161 	__GETB1MN _rxBuffer,1
000174 17e1      	CP   R30,R17
000175 f028      	BRLO _0x30
                 ;     384 			{
                 ;     385 				a=a+rxBuffer [b];
000176 d169      	RCALL SUBOPT_0xD
000177 d16f      	RCALL SUBOPT_0x10
000178 0f0e      	ADD  R16,R30
                 ;     386 			} 
000179 5f1f      	SUBI R17,-1
00017a cff7      	RJMP _0x2F
                 _0x30:
                 ;     387 		if (a == CRCPackRX) return 255;	 	//Ok
00017b 1680      	CP   R8,R16
00017c f411      	BRNE _0x31
00017d efef      	LDI  R30,LOW(255)
00017e c015      	RJMP _0x68
                 ;     388 		else return 0;
                 _0x31:
00017f e0e0      	LDI  R30,LOW(0)
000180 c013      	RJMP _0x68
                 ;     389 	}
                 ;     390 
                 ;     391 // Подсчет CRC передающего буффера
                 ;     392 unsigned char checkCRCtx (void)
                 ;     393 	{
                 _checkCRCtx:
                 ;     394 		unsigned char a =0, b;    
                 ;     395 
                 ;     396 		for (b=0;b< txBuffer [0]; b++)
000181 d1bc      	RCALL __SAVELOCR2
                 ;	a -> R16
                 ;	b -> R17
000182 e000      	LDI  R16,0
000183 e010      	LDI  R17,LOW(0)
                 _0x34:
000184 91e0 0260 	LDS  R30,_txBuffer
000186 171e      	CP   R17,R30
000187 f428      	BRSH _0x35
                 ;     397 			{
                 ;     398 				a=a+txBuffer [b];
000188 d157      	RCALL SUBOPT_0xD
000189 d152      	RCALL SUBOPT_0xC
00018a 0f0e      	ADD  R16,R30
                 ;     399 			} 
00018b 5f1f      	SUBI R17,-1
00018c cff7      	RJMP _0x34
                 _0x35:
                 ;     400 			
                 ;     401 		if (a == txBuffer [b]) 
00018d d152      	RCALL SUBOPT_0xD
00018e d14d      	RCALL SUBOPT_0xC
00018f 17e0      	CP   R30,R16
000190 f411      	BRNE _0x36
                 ;     402 			{
                 ;     403 				return 255;	 	//Ok
000191 efef      	LDI  R30,LOW(255)
000192 c001      	RJMP _0x68
                 ;     404 			}
                 ;     405 		else return 0;
                 _0x36:
000193 e0e0      	LDI  R30,LOW(0)
                 ;     406 	}
                 _0x68:
000194 d1b0      	RCALL __LOADLOCR2P
000195 9508      	RET
                 ;     407 
                 ;     408 // Обрабатываем входящий пакет
                 ;     409 void workINpack ( void )
                 ;     410 		{
                 _workINpack:
                 ;     411 			unsigned char a;
                 ;     412 
                 ;     413 		if (rxBuffer[2]==0)				// проверяем адрес. 0-обработка.Остальное-ретранслируем
000196 930a      	ST   -Y,R16
                 ;	a -> R16
000197 91e0 0162 	__GETB1MN _rxBuffer,2
000199 30e0      	CPI  R30,0
00019a f511      	BRNE _0x38
                 ;     414 			{
                 ;     415 					switch (rxBuffer[3])
00019b 91e0 0163 	__GETB1MN _rxBuffer,3
                 ;     416 						{
                 ;     417 							case GetLogAddr:				// возвращаем лог. адрес
00019d 30e1      	CPI  R30,LOW(0x1)
00019e f421      	BRNE _0x3C
                 ;     418 									_GetLogAddr ();		
00019f dfbc      	RCALL __GetLogAddr
                 ;     419 									rxPack = 0;				// пакет обработан
0001a0 94e8      	CLT
0001a1 f824      	BLD  R2,4
                 ;     420 									break;
0001a2 c019      	RJMP _0x3B
                 ;     421 
                 ;     422 							case OP:							// отладочные пакеты
                 _0x3C:
0001a3 36e4      	CPI  R30,LOW(0x64)
0001a4 f421      	BRNE _0x3D
                 ;     423 									readAddrDevice(); 
0001a5 d083      	RCALL _readAddrDevice
                 ;     424 									rxPack = 0;				// пакет обработан
0001a6 94e8      	CLT
0001a7 f824      	BLD  R2,4
                 ;     425 									break;
0001a8 c013      	RJMP _0x3B
                 ;     426 
                 ;     427 							case pingPack :
                 _0x3D:
0001a9 30e2      	CPI  R30,LOW(0x2)
0001aa f479      	BRNE _0x40
                 ;     428 									LedInv();
0001ab 94e8      	CLT
0001ac 9b93      	SBIS 0x12,3
0001ad 9468      	SET
0001ae b3a2      	IN   R26,0x12
0001af f9a3      	BLD  R26,3
0001b0 bba2      	OUT  0x12,R26
                 ;     429 
                 ;     430 									if (rxPackUART) 
0001b1 fe26      	SBRS R2,6
0001b2 c004      	RJMP _0x3F
                 ;     431 										{
                 ;     432 											txPack = 1;		 	// есть пакет на передачу
0001b3 9468      	SET
0001b4 f825      	BLD  R2,5
                 ;     433 											rxPackUART = 0;	// пакет обработан
0001b5 94e8      	CLT
0001b6 f826      	BLD  R2,6
                 ;     434 										}
                 ;     435 									rxPack = 0;					// пакет обработан
                 _0x3F:
0001b7 94e8      	CLT
0001b8 f824      	BLD  R2,4
                 ;     436 									break; 
0001b9 c002      	RJMP _0x3B
                 ;     437 
                 ;     438 							default:
                 _0x40:
                 ;     439 									rxPack = 0;					// пакет обработан
0001ba 94e8      	CLT
0001bb f824      	BLD  R2,4
                 ;     440 										
                 ;     441 						}
                 _0x3B:
                 ;     442             }
                 ;     443 		else if (rxBuffer[2]==pAddr) 							////////////// Мой адрес. Обращаются ко мне
0001bc c04b      	RJMP _0x41
                 _0x38:
0001bd 91a0 0162 	__GETB2MN _rxBuffer,2
0001bf 164a      	CP   R4,R26
0001c0 f509      	BRNE _0x42
                 ;     444 			{
                 ;     445 					switch (rxBuffer[3])
0001c1 91e0 0163 	__GETB1MN _rxBuffer,3
                 ;     446 						{
                 ;     447 							case PT_GETINFO:			// возвращаем о себе информацию
0001c3 30e3      	CPI  R30,LOW(0x3)
0001c4 f421      	BRNE _0x46
                 ;     448 //print = 1;
                 ;     449 									GetInfo();
0001c5 df4f      	RCALL _GetInfo_G1
                 ;     450 									rxPack = 0;					// пакет обработан
0001c6 94e8      	CLT
0001c7 f824      	BLD  R2,4
                 ;     451 									break;           
0001c8 c018      	RJMP _0x45
                 ;     452 
                 ;     453 							case PT_GETSTATE:
                 _0x46:
0001c9 30e1      	CPI  R30,LOW(0x1)
0001ca f421      	BRNE _0x47
                 ;     454 									GetState();
0001cb df2b      	RCALL _GetState_G1
                 ;     455 									rxPack = 0;					// пакет обработан
0001cc 94e8      	CLT
0001cd f824      	BLD  R2,4
                 ;     456 									break;
0001ce c012      	RJMP _0x45
                 ;     457 
                 ;     458 					 		case PT_TOPROG:       			// переходим в программирование
                 _0x47:
0001cf 30e7      	CPI  R30,LOW(0x7)
0001d0 f421      	BRNE _0x48
                 ;     459 									ToProg();
0001d1 df15      	RCALL _ToProg_G1
                 ;     460 									rxPack = 0;					// пакет обработан
0001d2 94e8      	CLT
0001d3 f824      	BLD  R2,4
                 ;     461 									break;      
0001d4 c00c      	RJMP _0x45
                 ;     462 
                 ;     463 					 		case PT_SETADDR:       			// переходим в программирование
                 _0x48:
0001d5 30e4      	CPI  R30,LOW(0x4)
0001d6 f419      	BRNE _0x49
                 ;     464 									Setaddr();
0001d7 d113      	RCALL SUBOPT_0x11
                 ;     465 									rxPack = 0;					// пакет обработан
0001d8 f824      	BLD  R2,4
                 ;     466 									break;      
0001d9 c007      	RJMP _0x45
                 ;     467 					 		case PT_SETSERIAL:       			// переходим в программирование
                 _0x49:
0001da 30e5      	CPI  R30,LOW(0x5)
0001db f419      	BRNE _0x4B
                 ;     468 									SetSerial();
0001dc d111      	RCALL SUBOPT_0x12
                 ;     469 									rxPack = 0;					// пакет обработан
0001dd f824      	BLD  R2,4
                 ;     470 									break;      
0001de c002      	RJMP _0x45
                 ;     471 
                 ;     472 
                 ;     473 							default:
                 _0x4B:
                 ;     474 									rxPack = 0;					// пакет обработан
0001df 94e8      	CLT
0001e0 f824      	BLD  R2,4
                 ;     475 						}
                 _0x45:
                 ;     476               }
                 ;     477 		else	if(rxBuffer[2] == TO_MON)					// обрабатываем пакет по адресу MONITOR
0001e1 c026      	RJMP _0x4C
                 _0x42:
0001e2 91e0 0162 	__GETB1MN _rxBuffer,2
0001e4 3fee      	CPI  R30,LOW(0xFE)
0001e5 f4a9      	BRNE _0x4D
                 ;     478 			{
                 ;     479 					switch (rxBuffer[3])
0001e6 91e0 0163 	__GETB1MN _rxBuffer,3
                 ;     480 						{
                 ;     481 					 		case PT_SETADDR:       			// переходим в программирование
0001e8 30e4      	CPI  R30,LOW(0x4)
0001e9 f419      	BRNE _0x51
                 ;     482 									Setaddr();
0001ea d100      	RCALL SUBOPT_0x11
                 ;     483 									rxPack = 0;					// пакет обработан
0001eb f824      	BLD  R2,4
                 ;     484 									break;      
0001ec c00d      	RJMP _0x50
                 ;     485 					 		case PT_SETSERIAL:       			// переходим в программирование
                 _0x51:
0001ed 30e5      	CPI  R30,LOW(0x5)
0001ee f419      	BRNE _0x52
                 ;     486 									SetSerial();
0001ef d0fe      	RCALL SUBOPT_0x12
                 ;     487 									rxPack = 0;					// пакет обработан
0001f0 f824      	BLD  R2,4
                 ;     488 									break; 
0001f1 c008      	RJMP _0x50
                 ;     489 					 		case PT_TOWORK:       			// переходим в программирование
                 _0x52:
0001f2 30eb      	CPI  R30,LOW(0xB)
0001f3 f421      	BRNE _0x54
                 ;     490 									ToWorkMode();
0001f4 ded8      	RCALL _ToWorkMode
                 ;     491 									rxPack = 0;					// пакет обработан
0001f5 94e8      	CLT
0001f6 f824      	BLD  R2,4
                 ;     492 									break; 
0001f7 c002      	RJMP _0x50
                 ;     493 									     
                 ;     494 							default:
                 _0x54:
                 ;     495 									rxPack = 0;					// пакет обработан
0001f8 94e8      	CLT
0001f9 f824      	BLD  R2,4
                 ;     496 						}
                 _0x50:
                 ;     497 			}
                 ;     498 		else
0001fa c00d      	RJMP _0x55
                 _0x4D:
                 ;     499 				{ 												///////////// иначе ретранслируем
                 ;     500 					for (a = 0;a<= (rxBuffer[1]+1); a++)
0001fb e000      	LDI  R16,LOW(0)
                 _0x57:
0001fc 91e0 0161 	__GETB1MN _rxBuffer,1
0001fe 5fef      	SUBI R30,-LOW(1)
0001ff 17e0      	CP   R30,R16
000200 f028      	BRLO _0x58
                 ;     501 						{
                 ;     502 							putchar (rxBuffer [a]);
000201 d0d7      	RCALL SUBOPT_0xB
000202 d0e4      	RCALL SUBOPT_0x10
000203 d0df      	RCALL SUBOPT_0xE
                 ;     503 						}
000204 5f0f      	SUBI R16,-1
000205 cff6      	RJMP _0x57
                 _0x58:
                 ;     504 					rxPack = 0;					// пакет обработан
000206 94e8      	CLT
000207 f824      	BLD  R2,4
                 ;     505 				}
                 _0x55:
                 _0x4C:
                 _0x41:
                 ;     506 			}	
000208 9109      	LD   R16,Y+
000209 9508      	RET
                 ;     507 
                 ;     508 // Обработка пакета, принятого по UART
                 ;     509 	void workUARTpack (void)
                 ;     510 		{
                 ;     511 			LedInv();
                 ;     512 
                 ;     513 			txPack = 1;							// есть пакет на передачу
                 ;     514 			rxPackUART = 0;				// пакет обработан
                 ;     515 		}			
                 ;     516 		
                 ;     517 
                 ;     518 
                 ;     519 // ----------------------- Обработка прерывания таймера 0 (тайм-аут RS232) --------
                 ;     520 // Timer 0 overflow interrupt service routine
                 ;     521 interrupt [TIM0_OVF] void timer0_ovf_isr(void)
                 ;     522 {
                 _timer0_ovf_isr:
00020a 93ea      	ST   -Y,R30
00020b b7ef      	IN   R30,SREG
00020c 93ea      	ST   -Y,R30
                 ;     523 	TCCR0=0x00;										// Останавливаем таймер
00020d d0e3      	RCALL SUBOPT_0x13
                 ;     524 	time_is_Out =1;		// взводим признак окончания таймаута
00020e 9468      	SET
00020f f822      	BLD  R2,2
                 ;     525 }
000210 91e9      	LD   R30,Y+
000211 bfef      	OUT  SREG,R30
000212 91e9      	LD   R30,Y+
000213 9518      	RETI
                 ;     526 //--------------------------------------------------------------------------------------
                 ;     527 
                 ;     528 // ----------------------- Обработка прерывания таймера 1 ( опрос подключения каждые 10 с) --------
                 ;     529 // Timer 1 overflow interrupt service routine
                 ;     530 interrupt [TIM1_OVF] void timer1_ovf_isr(void)
                 ;     531 {
                 _timer1_ovf_isr:
000214 93ea      	ST   -Y,R30
000215 b7ef      	IN   R30,SREG
                 ;     532 	tstPort = 1;						// пора проверить устройство присутствует ли ?
000216 9468      	SET
000217 f827      	BLD  R2,7
                 ;     533 }
000218 bfef      	OUT  SREG,R30
000219 91e9      	LD   R30,Y+
00021a 9518      	RETI
                 ;     534 
                 ;     535 
                 ;     536 
                 ;     537 
                 ;     538 
                 ;     539 // Пускаем таймер таймаута
                 ;     540 void timeOutStart (void)
                 ;     541 		{
                 _timeOutStart:
                 ;     542 			time_is_Out = 0;			// сброс флага таймаута
00021b 94e8      	CLT
00021c f822      	BLD  R2,2
                 ;     543 			TCNT0=0x00;
00021d d0d6      	RCALL SUBOPT_0x14
                 ;     544 			TCCR0=0x05;      									// пускаем таймер
00021e e0e5      	LDI  R30,LOW(5)
00021f bfe3      	OUT  0x33,R30
                 ;     545 		}
000220 9508      	RET
                 ;     546 
                 ;     547 // Пускаем таймер таймаута
                 ;     548 void timeOutStop (void)
                 ;     549 		{
                 _timeOutStop:
                 ;     550 			TCCR0=0x0;      									// останов таймера
000221 d0cf      	RCALL SUBOPT_0x13
                 ;     551 		}
000222 9508      	RET
                 ;     552 
                 ;     553 // процесс определения физического адреса порта и ответа
                 ;     554 // на первичный пинг (0хАА) главного процессора
                 ;     555 void inidevice (void)
                 ;     556 		{                                      
                 _inidevice:
                 ;     557 		pAddr = ((PINC & 0x7)+1 );			// определяем физический адрес (0-не исп. т.к. Глоб. Вызов)
000223 b3e3      	IN   R30,0x13
000224 70e7      	ANDI R30,LOW(0x7)
000225 5fef      	SUBI R30,-LOW(1)
000226 2e4e      	MOV  R4,R30
                 ;     558 		TWAR = (pAddr<<1)+1;					// Устанавливаем его для TWI
000227 d0cf      	RCALL SUBOPT_0x15
                 ;     559 
                 ;     560 //		while (! ping);								// ждем первый пинг 0хАА
                 ;     561 
                 ;     562 		}                                  
000228 9508      	RET
                 ;     563 		
                 ;     564 // Прием байта из UART. Контролируем тайм-аутом		
                 ;     565 unsigned char havechar(void)
                 ;     566 {
                 ;     567 	timeOutStart ();													// пускаем таймер
                 ;     568 	while (!( UCSRA & (1 << RXC)))
                 ;     569 		{
                 ;     570    		    if (time_is_Out)	
                 ;     571    		    	{
                 ;     572 	                dPresent = 0;					//  устройство не ответило
                 ;     573 					timeOutStop ();				// останов таймера
                 ;     574    			    	return 0;						// если нет байта то проверяем таймаут
                 ;     575    		    	}
                 ;     576 		}
                 ;     577 	timeOutStop ();								// останов таймера
                 ;     578     dPresent = 1;									//взводим признак наличия устройства
                 ;     579 
                 ;     580 	return 255;
                 ;     581 }
                 ;     582 
                 ;     583 
                 ;     584 // Проверяем что подключено к пору RS232
                 ;     585 // Если есть устройство - определяем адрес и вносим в таблицу адресов
                 ;     586 // Если нет ничего - сканируем до обнаружения. Сопровождаем морганием светодиода
                 ;     587 void 	readAddrDevice (void)                                                          
                 ;     588 		{
                 _readAddrDevice:
                 ;     589 				give_GETINFO();
000229 df3c      	RCALL _give_GETINFO_G1
                 ;     590 
                 ;     591 				timeOutStart();
00022a dff0      	RCALL _timeOutStart
                 ;     592 				while (!(rxPackUART))					// ждем отклик
                 _0x5D:
00022b fc26      	SBRC R2,6
00022c c00f      	RJMP _0x5F
                 ;     593 				{
                 ;     594 					if (time_is_Out )
00022d fe22      	SBRS R2,2
00022e c005      	RJMP _0x60
                 ;     595 						{
                 ;     596 							LedOn();								// моргаем светодиодом при проблемах связи
00022f 9893      	CBI  0x12,3
                 ;     597 			                dPresent = 0;			 			//  устройство не ответило
000230 94e8      	CLT
000231 f821      	BLD  R2,1
                 ;     598 		    	            lAddr = 0;					 			// Адрес = 0
000232 2455      	CLR  R5
                 ;     599 							break;
000233 c008      	RJMP _0x5F
                 ;     600 						} 
                 ;     601 					else  
                 _0x60:
                 ;     602 						{
                 ;     603 							dPresent = 1;						// ответило 
000234 9468      	SET
000235 f821      	BLD  R2,1
                 ;     604 							lAddr = txBuffer [37];			// вынимаем адрес из принятого пакта             
000236 9050 0285 	__GETBRMN 5,_txBuffer,37
                 ;     605 							LedOff();							// тушим индикатор проблем
000238 9a93      	SBI  0x12,3
                 ;     606 
                 ;     607 							tstPort = 0;						// устройство присутствует
000239 94e8      	CLT
00023a f827      	BLD  R2,7
                 ;     608 						}
                 ;     609 					
                 ;     610 				}        
00023b cfef      	RJMP _0x5D
                 _0x5F:
                 ;     611 				timeOutStop();
00023c dfe4      	RCALL _timeOutStop
                 ;     612 								
                 ;     613 				
                 ;     614 				if (dPresent) txPack = 1;					// есть пакет на передачу
00023d fe21      	SBRS R2,1
00023e c002      	RJMP _0x62
00023f 9468      	SET
000240 f825      	BLD  R2,5
                 ;     615 				rxPackUART = 0;							// принятый пакет - в отправке
                 _0x62:
000241 94e8      	CLT
000242 f826      	BLD  R2,6
                 ;     616 		}
000243 9508      	RET
                 ;     617 
                 ;     618 void main(void)
                 ;     619 {
                 _main:
                 ;     620 // Declare your local variables here
                 ;     621 
                 ;     622 // Input/Output Ports initialization
                 ;     623 
                 ;     624 PORTB=0x00;
000244 e0e0      	LDI  R30,LOW(0)
000245 bbe8      	OUT  0x18,R30
                 ;     625 DDRB=0x00;
000246 bbe7      	OUT  0x17,R30
                 ;     626 
                 ;     627 PORTC=0x07;
000247 e0e7      	LDI  R30,LOW(7)
000248 bbe5      	OUT  0x15,R30
                 ;     628 DDRC=0x00;
000249 e0e0      	LDI  R30,LOW(0)
00024a bbe4      	OUT  0x14,R30
                 ;     629 
                 ;     630 PORTD=0x00;
00024b bbe2      	OUT  0x12,R30
                 ;     631 DDRD=0x1C;
00024c e1ec      	LDI  R30,LOW(28)
00024d bbe1      	OUT  0x11,R30
                 ;     632 
                 ;     633 // Timer/Counter 0 initialization
                 ;     634 // Clock source: System Clock
                 ;     635 // Clock value: 7,813 kHz
                 ;     636 TCCR0=0x00;
00024e d0a2      	RCALL SUBOPT_0x13
                 ;     637 TCNT0=0x00;
00024f d0a4      	RCALL SUBOPT_0x14
                 ;     638 
                 ;     639 
                 ;     640 // Timer/Counter 1 initialization
                 ;     641 // Clock source: System Clock
                 ;     642 // Clock value: 7,813 kHz
                 ;     643 // Mode: Normal top=FFFFh
                 ;     644 // OC1A output: Discon.
                 ;     645 // OC1B output: Discon.
                 ;     646 // Noise Canceler: On
                 ;     647 // Input Capture on Falling Edge
                 ;     648 // Timer 1 Overflow Interrupt: On
                 ;     649 // Input Capture Interrupt: Off
                 ;     650 // Compare A Match Interrupt: Off
                 ;     651 // Compare B Match Interrupt: Off
                 ;     652 TCCR1A=0x00;
000250 e0e0      	LDI  R30,LOW(0)
000251 bdef      	OUT  0x2F,R30
                 ;     653 TCCR1B=0x85;
000252 e8e5      	LDI  R30,LOW(133)
000253 bdee      	OUT  0x2E,R30
                 ;     654 TCNT1H=0x00;
000254 d046      	RCALL SUBOPT_0x1
                 ;     655 TCNT1L=0x00;
                 ;     656 ICR1H=0x67;
000255 e6e7      	LDI  R30,LOW(103)
000256 bde7      	OUT  0x27,R30
                 ;     657 ICR1L=0x69;
000257 e6e9      	LDI  R30,LOW(105)
000258 bde6      	OUT  0x26,R30
                 ;     658 OCR1AH=0x00;
000259 e0e0      	LDI  R30,LOW(0)
00025a bdeb      	OUT  0x2B,R30
                 ;     659 OCR1AL=0x00;
00025b bdea      	OUT  0x2A,R30
                 ;     660 OCR1BH=0x00;
00025c bde9      	OUT  0x29,R30
                 ;     661 OCR1BL=0x00;
00025d bde8      	OUT  0x28,R30
                 ;     662 
                 ;     663 // Timer/Counter 2 initialization
                 ;     664 // Clock source: System Clock
                 ;     665 // Clock value: Timer 2 Stopped
                 ;     666 // Mode: Normal top=FFh
                 ;     667 // OC2 output: Disconnected
                 ;     668 ASSR=0x00;
00025e bde2      	OUT  0x22,R30
                 ;     669 TCCR2=0x00;
00025f bde5      	OUT  0x25,R30
                 ;     670 TCNT2=0x00;
000260 bde4      	OUT  0x24,R30
                 ;     671 OCR2=0x00;
000261 bde3      	OUT  0x23,R30
                 ;     672 
                 ;     673 // External Interrupt(s) initialization
                 ;     674 // INT0: Off
                 ;     675 // INT1: Off
                 ;     676 MCUCR=0x00;
000262 bfe5      	OUT  0x35,R30
                 ;     677 
                 ;     678 // Timer(s)/Counter(s) Interrupt(s) initialization
                 ;     679 TIMSK=0x05;
000263 e0e5      	LDI  R30,LOW(5)
000264 bfe9      	OUT  0x39,R30
                 ;     680 
                 ;     681 
                 ;     682 // USART initialization
                 ;     683 // Communication Parameters: 8 Data, 1 Stop, No Parity
                 ;     684 // USART Receiver: On
                 ;     685 // USART Transmitter: On
                 ;     686 // USART Mode: Asynchronous
                 ;     687 // USART Baud rate: 38400
                 ;     688 UCSRA=0x00;
000265 e0e0      	LDI  R30,LOW(0)
000266 b9eb      	OUT  0xB,R30
                 ;     689 UCSRB=0x98;
000267 e9e8      	LDI  R30,LOW(152)
000268 b9ea      	OUT  0xA,R30
                 ;     690 UCSRC=0x86;
000269 e8e6      	LDI  R30,LOW(134)
00026a bde0      	OUT  0x20,R30
                 ;     691 UBRRH=0x00;
00026b e0e0      	LDI  R30,LOW(0)
00026c bde0      	OUT  0x20,R30
                 ;     692 UBRRL=0x0C;
00026d e0ec      	LDI  R30,LOW(12)
00026e b9e9      	OUT  0x9,R30
                 ;     693 
                 ;     694 
                 ;     695 // Analog Comparator initialization
                 ;     696 // Analog Comparator: Off
                 ;     697 // Analog Comparator Input Capture by Timer/Counter 1: Off
                 ;     698 ACSR=0x80;
00026f e8e0      	LDI  R30,LOW(128)
000270 b9e8      	OUT  0x8,R30
                 ;     699 SFIOR=0x00;
000271 e0e0      	LDI  R30,LOW(0)
000272 bfe0      	OUT  0x30,R30
                 ;     700 
                 ;     701 // 2 Wire Bus initialization
                 ;     702 // Generate Acknowledge Pulse: On
                 ;     703 // 2 Wire Bus Slave Address: 8h
                 ;     704 // General Call Recognition: On
                 ;     705 // Bit Rate: 400,000 kHz
                 ;     706 TWSR=0x00;
000273 b9e1      	OUT  0x1,R30
                 ;     707 TWBR=0x02;
000274 e0e2      	LDI  R30,LOW(2)
000275 b9e0      	OUT  0x0,R30
                 ;     708 TWAR=(pAddr<<1)+1;
000276 d080      	RCALL SUBOPT_0x15
                 ;     709 TWCR=0x45;
000277 e4e5      	LDI  R30,LOW(69)
000278 bfe6      	OUT  0x36,R30
                 ;     710 
                 ;     711 // Global enable interrupts
                 ;     712 #asm("sei")
000279 9478      	sei
                 ;     713 
                 ;     714 	    LedOff();
00027a 9a93      	SBI  0x12,3
                 ;     715 		inidevice();  						// ждем сканирования
00027b dfa7      	RCALL _inidevice
                 ;     716 	    LedOn();                                                              
00027c 9893      	CBI  0x12,3
                 ;     717 putchar (0xab);		
00027d eaeb      	LDI  R30,LOW(171)
00027e d064      	RCALL SUBOPT_0xE
                 ;     718 while (1)
                 _0x63:
                 ;     719       {       
                 ;     720 
                 ;     721 //		if ((!(dPresent)) || (tstPort)) readAddrDevice(); 	 	// если нет устройства - ищем его
                 ;     722 		if (rxPack) workINpack();			// принят пакет TWI 
00027f fc24      	SBRC R2,4
000280 df15      	RCALL _workINpack
                 ;     723       };
000281 cffd      	RJMP _0x63
                 ;     724 }
                 _0x67:
000282 cfff      	RJMP _0x67
                 
                 _getchar:
000283 9b5f           sbis usr,rxc
000284 cffe           rjmp _getchar
000285 b1ec           in   r30,udr
000286 9508      	RET
                 _putchar:
000287 9b5d           sbis usr,udre
000288 cffe           rjmp _putchar
000289 81e8           ld   r30,y
00028a b9ec           out  udr,r30
00028b 9621      	ADIW R28,1
00028c 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x0:
00028d 920a      	ST   -Y,R0
00028e 921a      	ST   -Y,R1
00028f 92fa      	ST   -Y,R15
000290 936a      	ST   -Y,R22
000291 937a      	ST   -Y,R23
000292 938a      	ST   -Y,R24
000293 939a      	ST   -Y,R25
000294 93aa      	ST   -Y,R26
000295 93ba      	ST   -Y,R27
000296 93ea      	ST   -Y,R30
000297 93fa      	ST   -Y,R31
000298 b7ef      	IN   R30,SREG
000299 93ea      	ST   -Y,R30
00029a 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x1:
00029b e0e0      	LDI  R30,LOW(0)
00029c bded      	OUT  0x2D,R30
00029d bdec      	OUT  0x2C,R30
00029e 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x2:
00029f 2dec      	MOV  R30,R12
0002a0 94c3      	INC  R12
0002a1 e0f0      	LDI  R31,0
0002a2 5ae0      	SUBI R30,LOW(-_txBuffer)
0002a3 4ffd      	SBCI R31,HIGH(-_txBuffer)
0002a4 8300      	ST   Z,R16
0002a5 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x3:
0002a6 91e9      	LD   R30,Y+
0002a7 bfef      	OUT  SREG,R30
0002a8 91f9      	LD   R31,Y+
0002a9 91e9      	LD   R30,Y+
0002aa 91b9      	LD   R27,Y+
0002ab 91a9      	LD   R26,Y+
0002ac 9199      	LD   R25,Y+
0002ad 9189      	LD   R24,Y+
0002ae 9179      	LD   R23,Y+
0002af 9169      	LD   R22,Y+
0002b0 90f9      	LD   R15,Y+
0002b1 9019      	LD   R1,Y+
0002b2 9009      	LD   R0,Y+
0002b3 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES
                 SUBOPT_0x4:
0002b4 2de7      	MOV  R30,R7
0002b5 9473      	INC  R7
0002b6 e0f0      	LDI  R31,0
0002b7 5ae0      	SUBI R30,LOW(-_rxBuffer)
0002b8 4ffe      	SBCI R31,HIGH(-_rxBuffer)
0002b9 01df      	MOVW R26,R30
0002ba b1e3      	IN   R30,0x3
0002bb 93ec      	ST   X,R30
0002bc 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x5:
0002bd 2de9      	MOV  R30,R9
0002be 9493      	INC  R9
0002bf e0f0      	LDI  R31,0
0002c0 5ae0      	SUBI R30,LOW(-_txBuffer)
0002c1 4ffd      	SBCI R31,HIGH(-_txBuffer)
0002c2 81e0      	LD   R30,Z
0002c3 b9e3      	OUT  0x3,R30
0002c4 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x6:
0002c5 b1e3      	IN   R30,0x3
0002c6 93ea      	ST   -Y,R30
0002c7 cfbf      	RJMP _putchar
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x7:
0002c8 e0e1      	LDI  R30,LOW(1)
0002c9 93e0 0260 	STS  _txBuffer,R30
0002cb 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES
                 SUBOPT_0x8:
0002cc e0e2      	LDI  R30,LOW(2)
0002cd 93e0 0260 	STS  _txBuffer,R30
0002cf 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x9:
0002d0 93fa      	ST   -Y,R31
0002d1 93ea      	ST   -Y,R30
0002d2 e4ea      	LDI  R30,LOW(__PT_GETSTATE_*2)
0002d3 e0f0      	LDI  R31,HIGH(__PT_GETSTATE_*2)
0002d4 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0xA:
0002d5 91e0 0260 	LDS  R30,_txBuffer
0002d7 50e1      	SUBI R30,LOW(1)
0002d8 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES
                 SUBOPT_0xB:
0002d9 2fe0      	MOV  R30,R16
0002da e0f0      	LDI  R31,0
0002db 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES
                 SUBOPT_0xC:
0002dc 5ae0      	SUBI R30,LOW(-_txBuffer)
0002dd 4ffd      	SBCI R31,HIGH(-_txBuffer)
0002de 81e0      	LD   R30,Z
0002df 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES
                 SUBOPT_0xD:
0002e0 2fe1      	MOV  R30,R17
0002e1 e0f0      	LDI  R31,0
0002e2 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 7 TIMES
                 SUBOPT_0xE:
0002e3 93ea      	ST   -Y,R30
0002e4 cfa2      	RJMP _putchar
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0xF:
0002e5 e0e3      	LDI  R30,LOW(3)
0002e6 cffc      	RJMP SUBOPT_0xE
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x10:
0002e7 5ae0      	SUBI R30,LOW(-_rxBuffer)
0002e8 4ffe      	SBCI R31,HIGH(-_rxBuffer)
0002e9 81e0      	LD   R30,Z
0002ea 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x11:
0002eb ddf1      	RCALL _Setaddr
0002ec 94e8      	CLT
0002ed 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x12:
0002ee dde4      	RCALL _SetSerial_G1
0002ef 94e8      	CLT
0002f0 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES
                 SUBOPT_0x13:
0002f1 e0e0      	LDI  R30,LOW(0)
0002f2 bfe3      	OUT  0x33,R30
0002f3 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x14:
0002f4 e0e0      	LDI  R30,LOW(0)
0002f5 bfe2      	OUT  0x32,R30
0002f6 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES
                 SUBOPT_0x15:
0002f7 2de4      	MOV  R30,R4
0002f8 0fee      	LSL  R30
0002f9 5fef      	SUBI R30,-LOW(1)
0002fa b9e2      	OUT  0x2,R30
0002fb 9508      	RET
                 
                 _memcpyf:
0002fc 8199      	ldd  r25,y+1
0002fd 8188      	ld   r24,y
0002fe 9600      	adiw r24,0
0002ff f041      	breq __memcpyf1
000300 81bd      	ldd  r27,y+5
000301 81ac      	ldd  r26,y+4
000302 81fb      	ldd  r31,y+3
000303 81ea      	ldd  r30,y+2
                 __memcpyf0:
000304 9005      	lpm  r0,z+
000305 920d      	st   x+,r0
000306 9701      	sbiw r24,1
000307 f7e1      	brne __memcpyf0
                 __memcpyf1:
000308 81fd      	ldd  r31,y+5
000309 81ec      	ldd  r30,y+4
00030a 9626      	adiw r28,6
00030b 9508      	ret
                 
                 _delay_ms:
00030c 91e9      	ld   r30,y+
00030d 91f9      	ld   r31,y+
00030e 9630      	adiw r30,0
00030f f039      	breq __delay_ms1
                 __delay_ms0:
000310 ed80
000311 e097
000312 9701
000313 f7f1      	__DELAY_USW 0x7D0
000314 95a8      	wdr
000315 9731      	sbiw r30,1
000316 f7c9      	brne __delay_ms0
                 __delay_ms1:
000317 9508      	ret
                 
                 __LSRD12:
000318 23ee      	TST  R30
000319 2e0e      	MOV  R0,R30
00031a 01fd      	MOVW R30,R26
00031b 01bc      	MOVW R22,R24
00031c f031      	BREQ __LSRD12R
                 __LSRD12L:
00031d 9576      	LSR  R23
00031e 9567      	ROR  R22
00031f 95f7      	ROR  R31
000320 95e7      	ROR  R30
000321 940a      	DEC  R0
000322 f7d1      	BRNE __LSRD12L
                 __LSRD12R:
000323 9508      	RET
                 
                 __GETW1PF:
000324 9005      	LPM  R0,Z+
000325 91f4      	LPM  R31,Z
000326 2de0      	MOV  R30,R0
000327 9508      	RET
                 
                 __EEPROMRDD:
000328 9612      	ADIW R26,2
000329 d003      	RCALL __EEPROMRDW
00032a 2f7f      	MOV  R23,R31
00032b 2f6e      	MOV  R22,R30
00032c 9712      	SBIW R26,2
                 
                 __EEPROMRDW:
00032d 9611      	ADIW R26,1
00032e d002      	RCALL __EEPROMRDB
00032f 2ffe      	MOV  R31,R30
000330 9711      	SBIW R26,1
                 
                 __EEPROMRDB:
000331 99e1      	SBIC EECR,EEWE
000332 cffe      	RJMP __EEPROMRDB
000333 93ff      	PUSH R31
000334 b7ff      	IN   R31,SREG
000335 94f8      	CLI
000336 bbae      	OUT  EEARL,R26
000337 bbbf      	OUT  EEARH,R27
000338 9ae0      	SBI  EECR,EERE
000339 b3ed      	IN   R30,EEDR
00033a bfff      	OUT  SREG,R31
00033b 91ff      	POP  R31
00033c 9508      	RET
                 
                 __SAVELOCR3:
00033d 932a      	ST   -Y,R18
                 __SAVELOCR2:
00033e 931a      	ST   -Y,R17
00033f 930a      	ST   -Y,R16
000340 9508      	RET
                 
                 __LOADLOCR3:
000341 812a      	LDD  R18,Y+2
                 __LOADLOCR2:
000342 8119      	LDD  R17,Y+1
000343 8108      	LD   R16,Y
000344 9508      	RET
                 
                 __LOADLOCR2P:
000345 9109      	LD   R16,Y+
000346 9119      	LD   R17,Y+
000347 9508      	RET
                 
                 ;END OF CODE MARKER
                 __END_OF_CODE:


RESOURCE USE INFORMATION
------------------------

Notice:
The register and instruction counts are symbol table hit counts,
and hence implicitly used resources are not counted, eg, the
'lpm' instruction without operands implicitly uses r0 and z,
none of which are counted.

x,y,z are separate entities in the symbol table and are
counted separately from r26..r31 here.

.dseg memory usage only counts static data declared with .byte

ATmega8 register use summary:
r0 :  12 r1 :   3 r2 :  47 r3 :   6 r4 :   4 r5 :   4 r6 :   4 r7 :   3 
r8 :   2 r9 :   3 r10:   5 r11:   3 r12:   3 r13:   0 r14:   0 r15:   2 
r16:  27 r17:  16 r18:   5 r19:   0 r20:   0 r21:   0 r22:   8 r23:   4 
r24:  16 r25:   6 r26:  25 r27:  11 r28:   4 r29:   1 r30: 247 r31:  41 
x  :   8 y  :  61 z  :  16 
Registers used: 30 out of 35 (85.7%)

ATmega8 instruction use summary:
adc   :   0 add   :   4 adiw  :   7 and   :   0 andi  :   2 asr   :   0 
bclr  :   0 bld   :  43 brbc  :   0 brbs  :   0 brcc  :   0 brcs  :   0 
break :   0 breq  :   7 brge  :   0 brhc  :   0 brhs  :   0 brid  :   0 
brie  :   0 brlo  :   4 brlt  :   0 brmi  :   0 brne  :  35 brpl  :   0 
brsh  :   2 brtc  :   0 brts  :   0 brvc  :   0 brvs  :   0 bset  :   0 
bst   :   0 cbi   :   2 cbr   :   0 clc   :   0 clh   :   0 cli   :   2 
cln   :   0 clr   :   6 cls   :   0 clt   :  22 clv   :   0 clz   :   0 
com   :   0 cp    :   8 cpc   :   0 cpi   :  22 cpse  :   0 dec   :   6 
eor   :   0 fmul  :   0 fmuls :   0 fmulsu:   0 icall :   0 ijmp  :   0 
in    :  19 inc   :   3 ld    :  27 ldd   :   9 ldi   :  94 lds   :  12 
lpm   :  12 lsl   :   1 lsr   :   1 mov   :  17 movw  :   9 mul   :   0 
muls  :   0 mulsu :   0 neg   :   0 nop   :   0 or    :   0 ori   :   0 
out   :  57 pop   :   1 push  :   1 rcall :  86 ret   :  42 reti  :   4 
rjmp  :  70 rol   :   0 ror   :   3 sbc   :   0 sbci  :   8 sbi   :   3 
sbic  :   1 sbis  :   3 sbiw  :   8 sbr   :   0 sbrc  :   8 sbrs  :   3 
sec   :   0 seh   :   0 sei   :   1 sen   :   0 ser   :   0 ses   :   0 
set   :  18 sev   :   0 sez   :   0 sleep :   0 spm   :   0 st    :  37 
std   :   0 sts   :  19 sub   :   0 subi  :  21 swap  :   0 tst   :   6 
wdr   :   1 
Instructions used: 48 out of 109 (44.0%)

ATmega8 memory use summary [bytes]:
Segment   Begin    End      Code   Data   Used    Size   Use%
---------------------------------------------------------------
[.cseg] 0x000000 0x000690   1616     64   1680    8192  20.5%
[.dseg] 0x000060 0x000360      0    512    512    1024  50.0%
[.eseg] 0x000000 0x000004      0      4      4     512   0.8%

Assembly complete, 0 errors, 11 warnings
